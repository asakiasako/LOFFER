---
layout: post
title: 数字调制与脉冲整形
date: 2019-08-14
Author: MinimaLife
tags: [tech, 光通信, 通信理论]
comments: true
toc: false
pinned: false
---

## 调制——频谱搬移

调制是干什么的呢？调制就是把要传递的信号“搬运”到规定的频率附近。在光通信领域，无需过多解释调制的必要性，因为只有特定频率的光才能在光纤内传输，而信号的频率是远远低于光的。

在调制中，我们把携带信息的原始信号叫做**基带信号**，把承载基带信号的高频信号叫做**载波**。

假定 s(t) 是一个余弦信号：

$$
s(t) = \cos(wt)
$$

调制就是乘以一个频率为 w<sub>c</sub> 的高频信号：

$$
S_{RF}(t) = \cos(wt)\cdot\cos(w_ct)
$$

通过三角公式转换后变成如下形式：

$$
S_{RF}(t) = \frac{\cos(w_c+w)t+\cos(w_c-w)t}{2}
$$

可以看到，频率为 $w$ 的信号被搬运到 $w_c\pm w$ 的频率上。这里要注意 $w_c$ 和 $w$ 的数量关系，$w_c$ 是远大于 $w$ 的。由于 $\cos$ 函数的对称性，我们将二者颠倒也不会改变结果，但它的形式却不符合实际的物理意义。

## 复杂调制——提高频谱的利用率

假设有一个实信号 f(t)，根据傅里叶变换：

$$
F(jw) = \int_{-\infty}^{\infty}f(t)\cdot e^{-jwt}\mathrm{d}t
$$

用欧拉公式转换一下：

$$
F(jw) = \int_{-\infty}^{\infty}f(t)\cdot\cos(wt)+j\int_{-\infty}^{\infty}f(t)\cdot\sin(wt)\mathrm{d}t
$$

很容易发现，实信号的傅里叶变换，实部为偶函数，虚部为奇函数，因此实函数的频谱幅度特性为偶函数。也就是说，实函数的频谱是一个关于 y 轴对称的函数。

信号在没有调制之前，频谱是关于 y 轴对称的，有一半在负频率上，因此它只占用了一半的频谱。但是当其搬运到 $w_c$ 附近时，则是实实在在占用了真实的频谱。而频谱的两边其实是对称的，因此另一半的频谱其实没有带来任何的信息量，也就是我们浪费了一半的频谱。

图

为了解决这个问题，最直观的办法是把频谱的一半砍掉，变成单边带频谱。这个过程是通过希尔伯特变换实现的，但在现实中这种做法很难应用，这里不作详述。不过可以想到的是，要实现非对称的频谱，那就必须使用复信号。

图

我们其实可以换一个思路：采用复信号，其实质是在幅度这个维度之外引入了相位这一个维度，其实不用做这么复杂的变换。这就是我们现在所熟知的相位调制。如果用频谱的角度来思考这个问题，相位调制使得搬移后的频谱不再对称，因而可以包含 2 倍多的信息，这就是为何引入相位调制能节省一半的带宽的原因——虽然这个信息并非如单边带频谱一样，分别分布在频谱的两边。

## 数字调制

数字调制的目的是将数字信号转换成模拟基带信号。

基带信号可以用下面的公式来表达：

$$
s(t) = \sum I_n g(t-nT_s)
$$

I_n 是我们要发送的数字信号。g(t) 是一个实函数，叫脉冲成形 (pulse shaping) 函数，起到了基带滤波和控制带外泄漏的作用。每个符号通过 g(t) 产生一个波形，把所有符号的波形在时间上累加起来，就形成了最终的基带信号。

## 脉冲成形 (Pulse Shaping) 与奈奎斯特第一准则

脉冲成形的主要目的是限制带外泄露，或者叫做通道间串扰。在光通信中，我们使用了波分复用技术，从而在一根光纤内传输多个通道的信息。可用的波长被分隔成多个通道，信号在各自的通道内传输，不会占用其它通道的频谱资源。

随着信号波特率的增加，信号所占用的带宽也随之增加，因此我们需要用脉冲成形滤波器来抑制通道间串扰。

从前面的只是可以知道，已调信号不过是基带信号的频谱搬移，因此限制了基带信号的带宽，也就限制了已调信号的带宽。

我们以一个冲击序列经过脉冲成形滤波器来表示基带信号：

$$
s(t) = \sum_{n=-\infty}^{\infty}I_n \delta (t-nT_s) * g(t)
$$

如果记

$$
I(t) = \sum_{n=-\infty}^{\infty}I_n \delta (t-nT_s)
$$

则 

$$
s(t) = I(t)*g(t)
$$

$I(t)$ 是一个冲激函数序列，其带宽是无限的，经过成形滤波器后，带宽被限制在一定范围内，因此 $g(t)$ 应该是一个低通滤波器。

接收机在 t = nT_s 时刻采样，如果希望采样到的值就是符号 $I_n$，则 g(t) 需要满足以下性质：

$$
g(nTs) = \left\{{\begin{array}{lcl}
1\quad n=0\\
0\quad n\neq0
\end{array}}\right.
$$

该定理即被称为奈奎斯特第一准则。只有满足这个准则，才能够实现脉冲成形的无符号间干扰。

最自然的脉冲成形滤波器为矩形函数，即：

$$
g(t) = \left\{{\begin{array}{lcl}
1\quad |t|\leq T_s/2\\
0\quad |t|>T_s/2
\end{array}}\right.
$$

而其频谱为 sinc 函数：

$$
G(w) = T_s\mathrm{sinc}(\frac{wT_s}{2\pi})
$$

其波形和频谱如图所示。

图

可以看出，矩形脉冲的带宽是无限的，而且衰减很慢，形成很强的带外泄露。

既然要抑制带外泄露，我们可以从频域来定义脉冲成形函数，例如在频域中使用一个矩形函数来滤波：

$$
G(w) = \left\{
{
\begin{aligned}
&T_s &&|w|\leq 2\pi B_0\\
&0 &&|w|> 2\pi B_0
\end{aligned}
}\right.
$$

其中，$B_0$ 为脉冲成形函数的最小带宽：

$$
B_0 = \frac{1}{2T_s}
$$

而其时域波形为 sinc 函数：

$$
g(t)=\mathrm{sinc}(\frac t{T_s})
$$

图

这个函数似乎是一个理想的低通滤波器：既满足了奈奎斯特第一准则，保证了采样点无码间串扰，又抑制了带外泄露。

但实际上，由于这个函数的衰减很慢，这样对采样时间的精确度就很高，否则所采集到的信号就会收到相邻符号波形的干扰。

这个函数带来的另外一个问题是，所需的时延很大。因为实际中的系统都是因果系统，而滤波器关于时间轴是对称的，因此我们必须将信号做一个延时，来加载这个滤波器。由于这个函数衰减很慢，因此我们需要加一个很大的延时，来让滤波器的边界趋近于0。

由此可以看到，码间干扰和带外泄露其实是一个互斥的关系，这也是很好理解的：如果将时域波形限制在一个有限区间内，那么频谱必定是无限宽；反之亦然。因此我们需要寻找一个滤波器，在频域内将信号限制在一定带宽内，而在时域上又能比较快的衰减，且满足奈奎斯特第一准则。

实际中我们常用的滤波器是升余弦滚降函数，是由升余弦函数和方波拼接得到的，它既保证了时域信号能够很快衰减，又保证了频域展宽在可接受范围内。

$$
G(w) = \left\{{
\begin{aligned}
&T_s    &&|w|\leq|1-\alpha|2\pi B_0\\
&\frac{T_s}{2}\bigg[1+\cos\frac{|w|-(1-\alpha)2\pi B_0}{4\alpha B_0}\bigg]  &&|1-\alpha|2\pi B_0<|w|\leq|1+\alpha|2\pi B_0\\
&0      &&|w|>|1+\alpha|2\pi B_0
\end{aligned}}\right.
$$

其时域波形为：

$$
g(t) = \mathrm{sinc}(\frac{t}{T_s})\frac{\cos(\pi\alpha t/T_s)}{1-(2\alpha t/T_s)}
$$

图

在实际应用中通常使用的滤波器叫做根升余弦滚降滤波器，也就是在发射和接受各设置一个滤波器，幅度为升余弦滤波器的平方根。这样做降低了滤波器实现的难度，但在整个系统中，依然是一个升余弦滚降滤波器。